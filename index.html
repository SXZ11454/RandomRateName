<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>dy专用免费名字评分</title>

  <!-- 设置网页图标 -->
  <link rel="icon" href="favicon.png" type="image/png">

  <!-- 加载可变字体 -->
  <style>
    @font-face {
      font-family: 'NotoSansSC';
      src: url('NotoSansSC-VF.ttf') format('truetype-variations');
      font-weight: 100 900;
      font-stretch: 100%;
      font-display: swap;
    }

    :root {
      --primary-color: #4CAF50;
      --danger-color: #f44336;
      --bg-gradient: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
      --card-shadow: 0 8px 24px rgba(0,0,0,0.1);
      --border-radius: 12px;
    }

    * {
      box-sizing: border-box;
    }

    html {
      height: 100%;
      overflow: hidden;
    }

    body {
      font-family: 'NotoSansSC', sans-serif;
      font-variation-settings: 'wght' 400;
      background: var(--bg-gradient);
      padding: 0;
      margin: 0;
      min-height: 100vh;
      max-height: 100vh;
      color: #333;
      transition: background 0.8s ease;
      overflow-x: hidden;
      overflow-y: auto;

      padding-top: 50px;

      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .main-container {
      width: 100%;
      max-width: 640px;
      padding: 0 15px;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    /* --- 标题区域：图标 + 文字 --- */
    .title-container {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 16px;
      margin-bottom: 30px;
    }

    .title-icon {
      height: 2.4em;
      width: auto;
      flex-shrink: 0;
      opacity: 0;
      transform: scale(0.5) rotate(-180deg);
      animation: spinFadeIn 1s ease forwards;
    }

    h1 {
      font-family: 'NotoSansSC', sans-serif;
      font-variation-settings: 'wght' 900;
      font-size: 2.3em;
      color: black;
      margin: 0;
      line-height: 1;
      opacity: 0;
      animation: titleFadeIn 0.8s 0.3s ease forwards;
    }

    /* --- 动画定义 --- */
    @keyframes spinFadeIn {
      to {
        opacity: 1;
        transform: scale(1) rotate(0deg);
      }
    }

    @keyframes titleFadeIn {
      to {
        opacity: 1;
      }
    }

    @keyframes fadeIn {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes slideInFromLeft {
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    @keyframes wave {
      0%, 100% { transform: translateX(-100%) scaleX(0.1); }
      50% { transform: translateX(0) scaleX(1); }
    }

    /* --- 输入区域 --- */
    .input-container {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 12px;
      margin-bottom: 30px;
      opacity: 0;
      transform: translateY(10px);
      animation: fadeIn 0.6s 0.4s ease forwards;
    }

    #nameInput {
      font-family: 'NotoSansSC', sans-serif;
      font-variation-settings: 'wght' 400;
      font-size: 16px;
      padding: 0 14px;
      width: 320px;
      max-width: 100%;
      border: 2px solid #ccc;
      border-radius: 10px;
      outline: none;
      background-color: white;
      transition: border-color 0.3s, box-shadow 0.3s;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
      height: 48px;
      line-height: 48px;
      text-align: left;
      position: relative;
    }

    #nameInput::after {
      content: '';
      position: absolute;
      left: 0;
      bottom: -2px;
      width: 100%;
      height: 2px;
      background: var(--primary-color);
      transform: scaleX(0);
      transform-origin: left;
      animation: wave 1.5s infinite ease-in-out;
      display: none;
    }

    #nameInput:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 4px rgba(76, 175, 80, 0.2);
    }


    #nameInput:focus::after {
      display: block;
    }

    /* --- 按钮通用样式 --- */
    .btn {
      font-family: 'NotoSansSC', sans-serif;
      font-variation-settings: 'wght' 900;
      font-size: 16px;
      color: white;
      border: none;
      padding: 0 20px;
      border-radius: 10px;
      cursor: pointer;
      height: 48px;
      min-width: 80px;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #submitBtn {
      background: var(--primary-color);
      box-shadow: 0 4px 10px rgba(76, 175, 80, 0.3);
    }

    #submitBtn:hover {
      background: #43a047;
      transform: translateY(-2px);
      box-shadow: 0 6px 14px rgba(76, 175, 80, 0.35);
    }

    #submitBtn:active {
      transform: translateY(0);
      box-shadow: 0 2px 6px rgba(76, 175, 80, 0.25);
    }

    #clearBtn {
      background: var(--danger-color);
      box-shadow: 0 4px 10px rgba(244, 67, 54, 0.3);
    }

    #clearBtn:hover {
      background: #d32f2f;
      transform: translateY(-2px);
      box-shadow: 0 6px 14px rgba(244, 67, 54, 0.35);
    }

    #clearBtn:active {
      transform: translateY(0);
      box-shadow: 0 2px 6px rgba(244, 67, 54, 0.25);
    }

    /* --- 表格样式 --- */
    table {
      font-family: 'NotoSansSC', sans-serif;
      font-variation-settings: 'wght' 400;
      width: 100%;
      max-width: 600px;
      margin: 40px auto 0;
      border-collapse: separate;
      border-spacing: 0;
      border-radius: var(--border-radius);
      overflow: hidden;
      box-shadow: var(--card-shadow);
      background-color: white;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.5s ease, transform 0.5s ease;
      display: none;
    }

    table.show {
      opacity: 1;
      transform: translateY(0);
      display: table;
    }

    th, td {
      padding: 14px 12px;
      text-align: center;
      border-bottom: 1px solid #eee;
      width: 33.333%;
    }

    th {
      background: #f8f9fa;
      color: #333;
      font-variation-settings: 'wght' 700;
    }

    tbody tr {
      opacity: 1;
      transform: translateY(0);
      height: auto;
      transition: all 0.3s;
    }

    /* 新增行动画 */
    tbody tr.new-row {
      animation: slideInFromLeft 0.4s ease forwards;
      opacity: 0;
      transform: translateX(-30px);
    }

    /* --- 分片式擦除动画：每行独立执行 --- */
    @keyframes wipeRow {
      0% {
        opacity: 1;
        transform: translateY(0);
        height: 48px;
        background-color: white;
        padding: 14px 12px;
      }
      100% {
        opacity: 0;
        transform: translateY(-50px);
        height: 0;
        background-color: transparent;
        padding: 0;
        border-bottom: none;
      }
    }

    /* 应用擦除动画的类 */
    tr.wipe-out {
      animation: wipeRow 0.4s ease forwards;
      position: relative;
      z-index: 1;
    }
  </style>

  <!-- --- 响应式适配手机 --- -->
  <style>
    @media (max-width: 600px) {
      h1 {
        font-size: 2.2em;
      }

      .title-icon {
        height: 2em;
      }

      .input-container {
        flex-direction: column;
        gap: 16px;
      }

      #nameInput,
      .btn {
        width: 100%;
        max-width: 320px;
        font-size: 16px;
        height: 48px !important;
        line-height: 48px;
      }

      body {
        padding: 15px;
        padding-top: 50px;
      }
    }
  </style>
</head>
<body>

  <div class="main-container">
    <!-- 标题：图标 + 文字 -->
    <div class="title-container">
      <img src="favicon.png" alt="图标" class="title-icon">
      <h1>dy专用免费名字评分</h1>
    </div>

    <!-- 输入区域 -->
    <div class="input-container">
      <input type="text" id="nameInput" placeholder="请输入您的名字" autocomplete="off" />
      <button id="submitBtn" class="btn">确定</button>
      <button id="clearBtn" class="btn">清除</button>
    </div>

    <!-- 表格 -->
    <table id="resultTable">
      <thead>
        <tr>
          <th>名字</th>
          <th>分数</th>
          <th>等级</th>
        </tr>
      </thead>
      <tbody id="tableBody">
        <!-- 动态插入 -->
      </tbody>
    </table>
  </div>

  <script>
    const input = document.getElementById('nameInput');
    const submitBtn = document.getElementById('submitBtn');
    const clearBtn = document.getElementById('clearBtn');
    const table = document.getElementById('resultTable');
    const tableBody = document.getElementById('tableBody');

    let records = [];
    let isClearing = false; // 标记是否正在进行清除动画
    let clearAnimationTimeouts = []; // 存储清除动画的超时ID

    function getScoreAndGrade() {
      const score = Math.floor(Math.random() * 26) + 75;
      let grade;
      if (score >= 75 && score <= 79) grade = "良好";
      else if (score >= 80 && score <= 89) grade = "优秀";
      else if (score >= 90 && score <= 100) grade = "完美";
      return { score, grade };
    }

    function addRecord(name) {
      const { score, grade } = getScoreAndGrade();
      records.unshift({ name, score, grade });
      if (records.length > 15) records.length = 15;
      renderTable(true); // 标记为新增
    }

    function renderTable(isAdd = false) {
      // 如果正在执行清除动画，跳过渲染
      if (isClearing) return;

      if (records.length === 0) {
        // 清空表格内容
        tableBody.innerHTML = '';
        table.classList.remove('show');
        return;
      }

      // 重建所有行
      const fragment = document.createDocumentFragment();
      
      records.forEach((record, index) => {
        const row = document.createElement('tr');
        
        // 仅新行添加动画类
        if (isAdd && index === 0) {
          row.classList.add('new-row');
        }
        
        row.innerHTML = `
          <td>${record.name}</td>
          <td>${record.score}</td>
          <td><strong>${record.grade}</strong></td>
        `;
        fragment.appendChild(row);
      });

      // 一次性更新DOM
      tableBody.innerHTML = '';
      tableBody.appendChild(fragment);

      // 显示表格
      table.classList.add('show');
    }

    function handleClear() {
      // 清理之前可能存在的清除动画超时
      clearAnimationTimeouts.forEach(timeoutId => clearTimeout(timeoutId));
      clearAnimationTimeouts = [];
      
      if (isClearing || records.length === 0) return;
      
      isClearing = true;
      records = [];
      
      const rows = Array.from(tableBody.querySelectorAll('tr'));
      
      // 如果没有行，直接隐藏表格
      if (rows.length === 0) {
        table.classList.remove('show');
        isClearing = false;
        return;
      }
      
      let completedRows = 0;
      
      // 从最后一行开始，逐行向上执行擦除动画
      rows.reverse().forEach((row, index) => {
        // 设置动画延迟，使从底部向上依次消失
        const timeoutId = setTimeout(() => {
          // 添加擦除动画类
          row.classList.add('wipe-out');
          
          // 动画结束后移除该行
          const animationEndHandler = function() {
            if (row.parentNode) {
              row.parentNode.removeChild(row);
            }
            
            completedRows++;
            
            // 如果所有行都处理完毕
            if (completedRows === rows.length) {
              table.classList.remove('show');
              isClearing = false;
            }
            
            // 清理事件监听器
            row.removeEventListener('animationend', animationEndHandler);
          };
          
          row.addEventListener('animationend', animationEndHandler, { once: true });
          
          // 添加备选超时，防止动画事件未触发
          const fallbackTimeout = setTimeout(() => {
            if (completedRows < rows.length && row.parentNode) {
              row.parentNode.removeChild(row);
              completedRows++;
              
              if (completedRows === rows.length) {
                table.classList.remove('show');
                isClearing = false;
              }
            }
          }, 600); // 比动画时间稍长
          
          clearAnimationTimeouts.push(fallbackTimeout);
        }, index * 200); // 每行延迟200ms
        
        clearAnimationTimeouts.push(timeoutId);
      });
      
      input.focus();
    }

    function handleSubmit() {
      const name = input.value.trim();
      if (name === '') return;
      addRecord(name);
      input.value = '';
      input.focus();
    }

    submitBtn.addEventListener('click', handleSubmit);
    clearBtn.addEventListener('click', handleClear);

    input.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') handleSubmit();
    });

    input.addEventListener('touchstart', () => {
      setTimeout(() => input.focus(), 300);
    });

    input.focus();
  </script>

</body>
</html>